* 恶意代码分析主要目的
  * 特征码：放到杀毒引擎中去
  * 分析报告
  * 专杀工具
* 恶意代码分析方法
  * 简要分析 
    * 快速分析技术：特征码提出来之后就放到白库（安装了全网应用）中，检查能否查杀出来
    * 日志分析技术
    * 目的是为了获取特征码和简要报告
  * 详细分析：分为静态分析/动态分析
    * 提取特征码
    * 详细分析报告
    * 专杀工具开发，弥补主引擎不足
    * 获取C2服务器地址
* 恶意代码类型
  * 后门
  * 僵尸网络
  * 下载器
  * 间谍软件
  * 启动器
  * 内核套件
  * 勒索软件
  * 蠕虫
* 静态分析基础
  * 在线反病毒引擎 vt，virscan
  * 获取哈希值 certutil
  * 查找字符串 strings工具，查看敏感字符串，如system32文件夹、可疑api、C2地址/很长的网址、
  * 查壳 peid，exeinfope 目前隐蔽的病毒不加壳，自身有其他手段
  * 导入导出函数 lordpe、ida 查看导入表中各个函数/导入表特征，可疑的：loadlibrary()+getprocaddress()、文件操作函数、资源段操作、创建远程线程+进程注入等操作、winexec函数、隐藏自身、进程权限操作、urldownload等网络操作、
  * 获取资源信息/pe文件资源段 lordpe可查看和导出资源段内容
  * ida分析
  * 在线沙箱 微步云沙箱，可选择软件环境office+Java+chrome等
* 动态分析
  * 火绒剑直接运行恶意代码，还可以监控进程操作行为，查看进程字符串
  * rundll32.exe可以运行dll文件，命令为 RUNDLL32.EXE <dllname>,<entrypoint> <optional arguments>
  * 注意注册表及其对应的操作
  * ollydebug附加恶意进程
  * wireshark抓包分析

***
***

* C2流量识别 
* 多引擎杀毒，一个虚拟机里面有各种杀软，功能类似vt，virscan
* 检测虚拟机/沙箱：进程里有vm相关的进程；设备管理器中有一些虚拟的设备，如网卡；特权指令；磁盘大小是否过小，是否默认桌面壁纸等等一些细节；睡眠或死循环一段时间（沙箱可以hook掉sleep()等一些系统函数）
* 使用loadlibrary()、getprocaddress()函数动态寻找函数地址就可疑，正常情况下直接include即可。
* 挖漏洞 病毒分析
* [rundll32.exe的强大功能](https://www.cnblogs.com/h2zZhou/p/8375816.html)
* 恶意dll可以注册服务，然后自启动。